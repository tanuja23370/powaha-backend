generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Cp {
  cp_id              String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  cp_full_name       String        @db.VarChar(150)
  cp_mobile          String        @db.VarChar(20)
  cp_email           String        @db.VarChar(255)
  cp_city            String?       @db.VarChar(100)
  cp_state           String?       @db.VarChar(100)
  cp_country         String?       @db.VarChar(100)
  cp_experience      String?
  cp_pref_aoo_json   Json?
  cp_id_proof_url    String?
  cp_status          String        @db.VarChar(30)
  cp_aoo_json        Json?
  cp_plan_id         String?       @db.Uuid
  cp_reviewed_by_uid String?       @db.Uuid
  cp_submitted_at    DateTime      @default(now()) @db.Timestamp(6)
  cp_reviewed_at     DateTime?     @db.Timestamp(6)
  cp_activated_at    DateTime?     @db.Timestamp(6)
  password_hash      String?       @db.VarChar(255)
  pin_hash           String?       @db.VarChar(255)
  is_password_set    Boolean       @default(false)
  is_pin_set         Boolean       @default(false)
  tbl_cp_bank        CpBank?
  tbl_cp_church_map  CpChurchMap[]
  tbl_cp_incentive   CpIncentive[]
  tbl_cp_lead        CpLead[]

  @@map("tbl_cp")
}

model CpBank {
  cp_id              String  @id @db.Uuid
  cp_bank_name       String? @db.VarChar(150)
  cp_bank_acct_no    String? @db.VarChar(50)
  cp_bank_ifsc       String? @db.VarChar(20)
  cp_bank_upi        String? @db.VarChar(100)
  cp_bank_ver_status String? @db.VarChar(20)
  tbl_cp             Cp      @relation(fields: [cp_id], references: [cp_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cp_bank_cp")

  @@map("tbl_cp_bank")
}

model LeadStage {
  lead_stage_id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_stage_code       String   @db.VarChar(30)
  lead_stage_seq_no     Int
  lead_stage_created_at DateTime @default(now()) @db.Timestamp(6)
  tbl_cp_lead           CpLead[]

  @@map("tbl_mst_lead_stage")
}

model CpLead {
  cp_lead_id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  cp_id                  String    @db.Uuid
  lead_stage_id          String    @db.Uuid
  lead_church_name       String    @db.VarChar(150)
  lead_church_addr_line1 String?   @db.VarChar(150)
  lead_church_addr_line2 String?   @db.VarChar(150)
  lead_church_city       String?   @db.VarChar(100)
  lead_church_state      String?   @db.VarChar(100)
  lead_church_type       String?   @db.VarChar(100)
  lead_contact_name      String?   @db.VarChar(150)
  lead_contact_mobile    String?   @db.VarChar(20)
  lead_notes             String?
  lead_created_at        DateTime  @default(now()) @db.Timestamp(6)
  tbl_cp                 Cp        @relation(fields: [cp_id], references: [cp_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cp_lead_cp")
  tbl_mst_lead_stage     LeadStage @relation(fields: [lead_stage_id], references: [lead_stage_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_cp_lead_stage")

  @@map("tbl_cp_lead")
}

model CpChurchMap {
  cp_id                   String     @db.Uuid
  chr_id                  String     @db.Uuid
  cp_church_attributed_at DateTime   @default(now()) @db.Timestamp(6)
  tbl_church              tbl_church @relation(fields: [chr_id], references: [chr_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cp_church_church")
  tbl_cp                  Cp         @relation(fields: [cp_id], references: [cp_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cp_church_cp")

  @@id([cp_id, chr_id], map: "pk_cp_church_map")
  @@map("tbl_cp_church_map")
}

model CpIncentive {
  cp_inc_id       String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  cp_id           String     @db.Uuid
  chr_id          String     @db.Uuid
  inc_type_id     String     @db.Uuid
  cp_plan_id      String     @db.Uuid
  cp_inc_amt      Decimal    @db.Decimal(12, 2)
  inc_status      String     @db.VarChar(20)
  inc_eligible_at DateTime   @db.Timestamp(6)
  inc_paid_at     DateTime?  @db.Timestamp(6)
  tbl_church      tbl_church @relation(fields: [chr_id], references: [chr_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_cp_inc_church")
  tbl_cp          Cp         @relation(fields: [cp_id], references: [cp_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_cp_inc_cp")

  @@map("tbl_cp_incentive")
}

model CpApplStatus {
  cp_appl_st_id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  cp_appl_st_code       String   @unique @db.VarChar(30)
  cp_appl_st_created_at DateTime @default(now()) @db.Timestamp(6)

  @@map("tbl_mst_cp_appl_status")
}

model tbl_audit {
  adt_id            String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  adt_tenant_scope  String    @db.VarChar(20)
  chr_id            String?   @db.Uuid
  adt_entity_type   String    @db.VarChar(50)
  adt_entity_id     String    @db.Uuid
  adt_action        String    @db.VarChar(50)
  adt_actor_usr_id  String?   @db.Uuid
  adt_actor_context String?   @db.VarChar(50)
  adt_ip_address    String?
  adt_old_data      Json?
  adt_new_data      Json?
  adt_created_at    DateTime? @default(now()) @db.Timestamp(6)
}

model tbl_church {
  chr_id                 String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  chr_code               String            @unique @db.VarChar(50)
  chr_name               String            @db.VarChar(150)
  chr_email              String?           @db.VarChar(255)
  chr_denomination       String?           @db.VarChar(100)
  chr_location           String?
  chr_timezone           String?           @db.VarChar(50)
  chr_subscription_plan  String?           @db.VarChar(50)
  chr_approval_status    String?           @default("PENDING") @db.VarChar(20)
  chr_approved_by        String?           @db.Uuid
  chr_approved_at        DateTime?         @db.Timestamp(6)
  chr_address            String?
  chr_city               String?           @db.VarChar(100)
  chr_state              String?           @db.VarChar(100)
  chr_country            String?           @db.VarChar(100)
  chr_pincode            String?           @db.VarChar(20)
  chr_created_at         DateTime?         @default(now()) @db.Timestamp(6)
  chr_created_by         String?           @db.Uuid
  chr_setup_token        String?
  chr_setup_token_expiry DateTime?         @db.Timestamp(6)
  tbl_platform_1         tbl_platform_1?   @relation(fields: [chr_approved_by], references: [plt_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_church_approver")
  tbl_church_user        tbl_church_user[]
  tbl_cp_church_map      CpChurchMap[]
  tbl_cp_incentive       CpIncentive[]
}

model tbl_church_applicants {
  chr_app_id           String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  chr_app_code         String?         @unique @db.Char(8)
  chr_app_name         String?         @db.VarChar(150)
  chr_app_email        String?         @db.VarChar(255)
  chr_app_denomination String?         @db.VarChar(100)
  chr_app_location     String?
  chr_app_timezone     String?         @db.VarChar(50)
  chr_app_city         String?         @db.VarChar(100)
  chr_app_state        String?         @db.VarChar(100)
  chr_app_country      String?         @db.VarChar(100)
  chr_app_pincode      String?         @db.VarChar(20)
  chr_app_status       String?         @default("PENDING") @db.VarChar(20)
  chr_app_approved_by  String?         @db.Uuid
  chr_app_approved_at  DateTime?       @db.Timestamp(6)
  chr_app_applied_on   DateTime?       @default(now()) @db.Timestamp(6)
  chr_app_address      String?         @db.VarChar(255)
  tbl_platform_1       tbl_platform_1? @relation(fields: [chr_app_approved_by], references: [plt_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_app_approver")
}

model tbl_church_user {
  chr_usr_id         Int             @id @default(autoincrement())
  chr_id             String          @db.Uuid
  usr_id             String          @db.Uuid
  role_id            Int
  chr_usr_status     String?         @default("ACTIVE") @db.VarChar(20)
  chr_usr_created_at DateTime?       @default(now()) @db.Timestamp(6)
  chr_usr_created_by String?         @db.Uuid
  tbl_church         tbl_church      @relation(fields: [chr_id], references: [chr_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_church_user_church")
  tbl_role_master    tbl_role_master @relation(fields: [role_id], references: [role_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_church_user_role")
  tbl_user_1         tbl_user_1      @relation(fields: [usr_id], references: [usr_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_church_user_user")

  @@unique([chr_id, usr_id, role_id], map: "uq_church_user")
}

model tbl_country_currency {
  cc_id            Int      @id @default(autoincrement())
  cc_country_name  String   @db.VarChar(100)
  cc_currency_name String   @db.VarChar(100)
  cc_currency_code String   @db.VarChar(3)
  cc_country_code  String   @unique @db.VarChar(2)
  cc_created_at    DateTime @default(now()) @db.Timestamp(6)

  @@index([cc_currency_code])
}

model tbl_platform_1 {
  plt_id                String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  plt_name              String                  @db.VarChar(150)
  plt_email             String                  @unique @db.VarChar(255)
  plt_phone             String?                 @unique @db.VarChar(20)
  plt_password          String
  plt_status            String?                 @default("ACTIVE") @db.VarChar(20)
  plt_email_verified    Boolean?                @default(false)
  plt_phone_verified    Boolean?                @default(false)
  plt_created_at        DateTime?               @default(now()) @db.Timestamp(6)
  plt_created_by        String?                 @db.Uuid
  plt_active_session_id String?                 @db.VarChar(255)
  plt_last_activity_at  DateTime?
  tbl_church            tbl_church[]
  tbl_church_applicants tbl_church_applicants[]
  tbl_platform_2        tbl_platform_2?
  tbl_platform_user     tbl_platform_user[]
}

model tbl_platform_2 {
  plt_id            String         @id @db.Uuid
  plt_address       String?
  plt_city          String?        @db.VarChar(100)
  plt_state         String?        @db.VarChar(100)
  plt_country       String?        @db.VarChar(100)
  plt_pincode       String?        @db.VarChar(20)
  plt_gender        String?        @db.VarChar(20)
  plt_dob           DateTime?      @db.Date
  plt_profile_image String?
  plt_created_at    DateTime?      @default(now()) @db.Timestamp(6)
  plt_created_by    String?        @db.Uuid
  tbl_platform_1    tbl_platform_1 @relation(fields: [plt_id], references: [plt_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_platform_profile")
}

model tbl_platform_user {
  plt_usr_id         Int             @id @default(autoincrement())
  plt_id             String          @db.Uuid
  role_id            Int
  plt_usr_created_at DateTime?       @default(now()) @db.Timestamp(6)
  tbl_platform_1     tbl_platform_1  @relation(fields: [plt_id], references: [plt_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_platform_user_platform")
  tbl_role_master    tbl_role_master @relation(fields: [role_id], references: [role_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_platform_user_role")

  @@unique([plt_id, role_id], map: "uq_platform_user")
}

model tbl_role_master {
  role_id           Int                 @id @default(autoincrement())
  role_code         String              @unique @db.VarChar(50)
  role_desc         String?             @db.VarChar(150)
  role_created_at   DateTime?           @default(now()) @db.Timestamp(6)
  tbl_church_user   tbl_church_user[]
  tbl_platform_user tbl_platform_user[]
}

model tbl_state_district {
  sd_id            Int      @id @default(autoincrement())
  sd_country_code  String   @db.VarChar(2)
  sd_state_name    String   @db.VarChar(100)
  sd_state_code    String   @db.VarChar(10)
  sd_district_name String   @db.VarChar(150)
  sd_created_at    DateTime @default(now()) @db.Timestamp(6)

  @@unique([sd_country_code, sd_state_code, sd_district_name])
  @@index([sd_state_code])
}

model tbl_user_1 {
  usr_id             String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  usr_name           String            @db.VarChar(150)
  usr_email          String            @unique @db.VarChar(255)
  usr_phone          String?           @unique @db.VarChar(20)
  usr_password       String
  usr_status         String?           @default("ACTIVE") @db.VarChar(20)
  usr_email_verified Boolean?          @default(false)
  usr_phone_verified Boolean?          @default(false)
  usr_created_at     DateTime?         @default(now()) @db.Timestamp(6)
  usr_created_by     String?           @db.Uuid
  tbl_church_user    tbl_church_user[]
  tbl_user_2         tbl_user_2?
}

model tbl_user_2 {
  usr_id            String     @id @db.Uuid
  usr_address       String?
  usr_city          String?    @db.VarChar(100)
  usr_state         String?    @db.VarChar(100)
  usr_country       String?    @db.VarChar(100)
  usr_pincode       String?    @db.VarChar(20)
  usr_gender        String?    @db.VarChar(20)
  usr_dob           DateTime?  @db.Date
  usr_profile_image String?
  usr_created_at    DateTime?  @default(now()) @db.Timestamp(6)
  usr_created_by    String?    @db.Uuid
  tbl_user_1        tbl_user_1 @relation(fields: [usr_id], references: [usr_id], onDelete: Cascade, onUpdate: NoAction, map: "fk_user_profile")
}
